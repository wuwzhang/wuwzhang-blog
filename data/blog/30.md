---
title: ç¬¬30æœŸ
date: '2021-03-30'
tags: ['èµ„è®¯']
draft: false
---

<TOCInline toc={props.toc} asDisclosure toHeading={3} />

## 2021/03/25

## æ¯å‘¨èµ„è®¯ - ç¬¬`30`æœŸ

### 1. [ä¸€æ–‡åƒé€`React`é«˜é˜¶ç»„ä»¶(`HOC`) (ä¸‹)](https://juejin.cn/post/6940422320427106335)

##### 2. æ§åˆ¶æ¸²æŸ“

æ§åˆ¶æ¸²æŸ“æ˜¯é«˜é˜¶ç»„ä»¶çš„ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§ï¼Œä¸Šè¾¹è¯´åˆ°çš„ä¸¤ç§é«˜é˜¶ç»„ä»¶ï¼Œéƒ½èƒ½å®Œæˆå¯¹ç»„ä»¶æ¸²æŸ“çš„æ§åˆ¶ã€‚å…·ä½“å®ç°è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼Œæˆ‘ä»¬ä¸€èµ·æ¥æ¢ç´¢ä¸€ä¸‹ã€‚

###### æ¡ä»¶æ¸²æŸ“

1. åŸºç¡€ï¼šåŠ¨æ€æ¸²æŸ“
   å¯¹äºå±æ€§ä»£ç†çš„é«˜é˜¶ç»„ä»¶ï¼Œè™½ç„¶ä¸èƒ½åœ¨å†…éƒ¨æ“æ§æ¸²æŸ“çŠ¶æ€ï¼Œä½†æ˜¯å¯ä»¥åœ¨å¤–å±‚æ§åˆ¶å½“å‰ç»„ä»¶æ˜¯å¦æ¸²æŸ“ï¼Œè¿™ç§æƒ…å†µåº”ç”¨äºï¼Œ**æƒé™éš”ç¦»ï¼Œæ‡’åŠ è½½ï¼Œå»¶æ—¶åŠ è½½**ç­‰åœºæ™¯ã€‚

å®ç°ä¸€ä¸ªåŠ¨æ€æŒ‚è½½ç»„ä»¶çš„`HOC`:

```jsx
function renderHOC(WrapComponent) {
  return class Index extends React.Component {
    constructor(props) {
      super(props)
      this.state = { visible: true }
    }

    setVisible() {
      this.setState({ visible: !this.state.visible })
    }

    render() {
      const { visible } = this.state
      return (
        <div className="box">
          <button onClick={this.setVisible.bind(this)}>æŒ‚è½½ç»„ä»¶</button>
          {visible ? (
            <WrapComponent {...this.props} setVisible={this.setVisible.bind(this)} />
          ) : (
            <div className="icon">
              <SyncOutlined spin className="theicon" />
            </div>
          )}
        </div>
      )
    }
  }
}

class Index extends React.Component {
  render() {
    const { setVisible } = this.props
    return (
      <div className="box">
        <p>hello,my name is alien</p>
        <img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=294206908,2427609994&fm=26&gp=0.jpg" />
        <button onClick={() => setVisible()}> å¸è½½å½“å‰ç»„ä»¶ </button>
      </div>
    )
  }
}
export default renderHOC(Index)
```

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/03c41d9ee9fa491cb3ae44d9cee1f2b3~tplv-k3u1fbpfcp-watermark.image)

2. è¿›é˜¶ ï¼šåˆ†ç‰‡æ¸²æŸ“
   è¿›é˜¶ï¼šå®ç°ä¸€ä¸ªæ‡’åŠ è½½åŠŸèƒ½çš„`HOC`ï¼Œå¯ä»¥å®ç°ç»„ä»¶çš„åˆ†ç‰‡æ¸²æŸ“,ç”¨äºåˆ†ç‰‡æ¸²æŸ“é¡µé¢ï¼Œä¸è‡³äºä¸€æ¬¡æ¸²æŸ“å¤§é‡ç»„ä»¶é€ æˆç™½å±æ•ˆæœ

```jsx
const renderQueue = []
let isFirstrender = false

const tryRender = () => {
  const render = renderQueue.shift()
  if (!render) return
  setTimeout(() => {
    render() /* æ‰§è¡Œä¸‹ä¸€æ®µæ¸²æŸ“ */
  }, 300)
}
/* HOC */
function renderHOC(WrapComponent) {
  return function Index(props) {
    const [isRender, setRender] = useState(false)
    useEffect(() => {
      renderQueue.push(() => {
        /* æ”¾å…¥å¾…æ¸²æŸ“é˜Ÿåˆ—ä¸­ */
        setRender(true)
      })
      if (!isFirstrender) {
        tryRender() /**/
        isFirstrender = true
      }
    }, [])
    return isRender ? (
      <WrapComponent tryRender={tryRender} {...props} />
    ) : (
      <div className="box">
        <div className="icon">
          <SyncOutlined spin />
        </div>
      </div>
    )
  }
}
/* ä¸šåŠ¡ç»„ä»¶ */
class Index extends React.Component {
  componentDidMount() {
    const { name, tryRender } = this.props
    /* ä¸Šä¸€éƒ¨åˆ†æ¸²æŸ“å®Œæ¯•ï¼Œè¿›è¡Œä¸‹ä¸€éƒ¨åˆ†æ¸²æŸ“ */
    tryRender()
    console.log(`${name}æ¸²æŸ“`)
  }

  render() {
    return (
      <div>
        <img src="https://ss2.bdstatic.com/70cFvnSh_Q1YnxGkpoWK1HF6hhy/it/u=294206908,2427609994&amp;fm=26&amp;gp=0.jpg" />
      </div>
    )
  }
}
/* é«˜é˜¶ç»„ä»¶åŒ…è£¹ */
const Item = renderHOC(Index)

export default () => (
  <>
    <Item name="ç»„ä»¶ä¸€" />
    <Item name="ç»„ä»¶äºŒ" />
    <Item name="ç»„ä»¶ä¸‰" />
  </>
)
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2d94687dda024392a37abec5e4756420~tplv-k3u1fbpfcp-watermark.image)
å¤§è‡´æµç¨‹ï¼Œåˆå§‹åŒ–çš„æ—¶å€™ï¼Œ`HOC`ä¸­å°†æ¸²æŸ“çœŸæ­£ç»„ä»¶çš„æ¸²æŸ“å‡½æ•°ï¼Œæ”¾å…¥`renderQueue`é˜Ÿåˆ—ä¸­ï¼Œç„¶ååˆå§‹åŒ–æ¸²æŸ“ä¸€æ¬¡ï¼Œæ¥ä¸‹æ¥ï¼Œæ¯ä¸€ä¸ªé¡¹ç›®ç»„ä»¶ï¼Œå®Œæˆ`didMounted`çŠ¶æ€åï¼Œä¼šä»é˜Ÿåˆ—ä¸­å–å‡ºä¸‹ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“ä¸‹ä¸€ä¸ªç»„ä»¶, ä¸€ç›´åˆ°æ‰€æœ‰çš„æ¸²æŸ“ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œæ¸²æŸ“é˜Ÿåˆ—æ¸…ç©ºï¼Œæœ‰æ•ˆçš„è¿›è¡Œåˆ†ç‰‡çš„æ¸²æŸ“ï¼Œè¿™ç§æ–¹å¼å¯¹æµ·é‡æ•°æ®å±•ç¤ºï¼Œå¾ˆå¥æ•ˆã€‚

ç”¨`HOC`å®ç°äº†æ¡ä»¶æ¸²æŸ“-åˆ†ç‰‡æ¸²æŸ“çš„åŠŸèƒ½ï¼Œå®é™…æ¡ä»¶æ¸²æŸ“ç†è§£èµ·æ¥å¾ˆå®¹æ˜“ï¼Œå°±æ˜¯é€šè¿‡å˜é‡ï¼Œæ§åˆ¶æ˜¯å¦æŒ‚è½½ç»„ä»¶ï¼Œä»è€Œæ»¡è¶³é¡¹ç›®æœ¬èº«éœ€æ±‚ï¼Œæ¡ä»¶æ¸²æŸ“å¯ä»¥æ¼”å˜æˆå¾ˆå¤šæ¨¡å¼ï¼Œæˆ‘è¿™é‡Œä»‹ç»äº†æ¡ä»¶æ¸²æŸ“çš„äºŒç§æ–¹å¼ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿç†è§£ç²¾é«“æ‰€åœ¨ã€‚

3. è¿›é˜¶ï¼šå¼‚æ­¥ç»„ä»¶(æ‡’åŠ è½½)
   ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰ç”¨è¿‡`dva`,é‡Œé¢çš„`dynamic`å°±æ˜¯åº”ç”¨`HOC`æ¨¡å¼å®ç°çš„ç»„ä»¶å¼‚æ­¥åŠ è½½ï¼Œè¿™é‡Œç®€åŒ–äº†ä¸€ä¸‹ï¼Œæç‚¼æ ¸å¿ƒä»£ç ï¼Œå¦‚ä¸‹ï¼š

```jsx
/* è·¯ç”±æ‡’åŠ è½½HOC */
export default function AsyncRouter(loadRouter) {
  return class Content extends React.Component {
    state = { Component: null }

    componentDidMount() {
      if (this.state.Component) return
      loadRouter()
        .then((module) => module.default)
        .then((Component) => this.setState({ Component }))
    }

    render() {
      const { Component } = this.state
      return Component ? <Component {...this.props} /> : null
    }
  }
}
```

ä½¿ç”¨

```jsx
const Index = AsyncRouter(() => import('../pages/index'))
```

`HOC`è¿˜å¯ä»¥é…åˆå…¶ä»–`API`ï¼Œåšä¸€ä¸‹è¡ç”Ÿçš„åŠŸèƒ½ã€‚å¦‚ä¸Šé…åˆ`import`å®ç°å¼‚æ­¥åŠ è½½åŠŸèƒ½ã€‚`HOC`ç”¨èµ·æ¥éå¸¸çµæ´»

4. åå‘ç»§æ‰¿ï¼šæ¸²æŸ“åŠ«æŒ
   `HOC`åå‘ç»§æ‰¿æ¨¡å¼ï¼Œå¯ä»¥å®ç°é¢—ç²’åŒ–çš„æ¸²æŸ“åŠ«æŒï¼Œä¹Ÿå°±æ˜¯å¯ä»¥æ§åˆ¶åŸºç±»ç»„ä»¶çš„`render`å‡½æ•°ï¼Œè¿˜å¯ä»¥ç¯¡æ”¹`props`ï¼Œæˆ–è€…æ˜¯`children`ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹ï¼Œè¿™ç§çŠ¶æ€ä¸‹ï¼Œæ€ä¹ˆä½¿ç”¨é«˜é˜¶ç»„ä»¶

```jsx
const HOC = (WrapComponent) =>
  class Index extends WrapComponent {
    render() {
      if (this.props.visible) {
        return super.render()
      } else {
        return <div>æš‚æ— æ•°æ®</div>
      }
    }
  }
```

5. åå‘ç»§æ‰¿ï¼šä¿®æ”¹æ¸²æŸ“æ ‘
   ä¿®æ”¹æ¸²æŸ“çŠ¶æ€(åŠ«æŒ`render`æ›¿æ¢å­èŠ‚ç‚¹)

```jsx
class Index extends React.Component {
  render() {
    return (
      <div>
        <ul>
          <li>react</li>
          <li>vue</li>
          <li>Angular</li>
        </ul>
      </div>
    )
  }
}

function HOC(Component) {
  return class Advance extends Component {
    render() {
      const element = super.render()
      const otherProps = {
        name: 'alien',
      }
      /* æ›¿æ¢ Angular å…ƒç´ èŠ‚ç‚¹ */
      const appendElement = React.createElement(
        'li',
        {},
        `hello ,world , my name  is ${otherProps.name}`
      )
      const newchild = React.Children.map(element.props.children.props.children, (child, index) => {
        if (index === 2) return appendElement
        return child
      })
      return React.cloneElement(element, element.props, newchild)
    }
  }
}
export default HOC(Index)
```

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8768ee8201e949d8a7c2f7c0ec72b1e4~tplv-k3u1fbpfcp-watermark.image)

æˆ‘ä»¬ç”¨åŠ«æŒæ¸²æŸ“çš„æ–¹å¼ï¼Œæ¥æ“çºµ`super.render()`åçš„`React.element`å…ƒç´ ï¼Œç„¶åé…åˆ`createElement`, `cloneElement`, `React.Children`ç­‰`api`,å¯ä»¥çµæ´»æ“çºµï¼ŒçœŸæ­£çš„æ¸²æŸ“`react.element`ï¼Œå¯ä»¥è¯´æ˜¯å·å¤©æ¢æ—¥ï¼Œä¸äº¦ä¹ä¹ã€‚

###### èŠ‚æµæ¸²æŸ“

`HOC`é™¤äº†å¯ä»¥è¿›è¡Œæ¡ä»¶æ¸²æŸ“ï¼Œæ¸²æŸ“åŠ«æŒåŠŸèƒ½å¤–ï¼Œè¿˜å¯ä»¥è¿›è¡ŒèŠ‚æµæ¸²æŸ“ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä¼˜åŒ–æ€§èƒ½ï¼Œå…·ä½“æ€ä¹ˆåšï¼Œè¯·è·Ÿä¸Šæˆ‘çš„èŠ‚å¥å¾€ä¸‹çœ‹ã€‚

1. åŸºç¡€: èŠ‚æµåŸç†
   `HOC`å¯ä»¥é…åˆ`hooks`çš„`useMemo`ç­‰`API`é…åˆä½¿ç”¨ï¼Œå¯ä»¥å®ç°å¯¹ä¸šåŠ¡ç»„ä»¶çš„æ¸²æŸ“æ§åˆ¶ï¼Œå‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼Œä»è€Œè¾¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„æ•ˆæœã€‚å¦‚ä¸‹æ¡ˆä¾‹ï¼Œæˆ‘ä»¬æœŸæœ›å½“ä¸”ä»…å½“`num`æ”¹å˜çš„æ—¶å€™ï¼Œæ¸²æŸ“ç»„ä»¶ï¼Œä½†æ˜¯ä¸å½±å“æ¥æ”¶çš„`props`ã€‚æˆ‘ä»¬åº”è¯¥è¿™æ ·å†™æˆ‘ä»¬çš„`HOC`ã€‚

```jsx
function HOC(Component) {
  return function renderWrapComponent(props) {
    const { num } = props
    const RenderElement = useMemo(() => <Component {...props} />, [num])
    return RenderElement
  }
}
class Index extends React.Component {
  render() {
    console.log(`å½“å‰ç»„ä»¶æ˜¯å¦æ¸²æŸ“`, this.props)
    return <div>hello,world, my name is alien </div>
  }
}
const IndexHoc = HOC(Index)

export default () => {
  const [num, setNumber] = useState(0)
  const [num1, setNumber1] = useState(0)
  const [num2, setNumber2] = useState(0)
  return (
    <div>
      <IndexHoc num={num} num1={num1} num2={num2} />
      <button onClick={() => setNumber(num + 1)}>num++</button>
      <button onClick={() => setNumber1(num1 + 1)}>num1++</button>
      <button onClick={() => setNumber2(num2 + 1)}>num2++</button>
    </div>
  )
}
```

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ed5c42a503645118da7fbdf1e0a9920~tplv-k3u1fbpfcp-watermark.image)
å¦‚å›¾æ‰€ç¤º,å½“æˆ‘ä»¬åªæœ‰ç‚¹å‡»`num++`æ—¶å€™ï¼Œæ‰é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œç‚¹å‡»å…¶ä»–æŒ‰é’®ï¼Œåªæ˜¯è´Ÿè´£ä¼ é€’äº†`props`, è¾¾åˆ°äº†æœŸæœ›çš„æ•ˆæœã€‚

2. è¿›é˜¶ï¼šå®šåˆ¶åŒ–æ¸²æŸ“æµ

æ€è€ƒï¼šğŸ¤” ä¸Šè¿°çš„æ¡ˆä¾‹åªæ˜¯ä»‹ç»äº†åŸç†ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæ˜¯é‡åŒ–ç”Ÿäº§ä¸äº†çš„ï¼ŒåŸå› æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹ä¸åŒ props å˜åŒ–ï¼Œå†™ä¸åŒçš„`HOC`ç»„ä»¶ï¼Œè¿™æ ·æ ¹æœ¬èµ·ä¸äº†`HOC`çœŸæ­£çš„ç”¨é€”ï¼Œä¹Ÿå°±æ˜¯`HOC`äº§ç”Ÿçš„åˆè¡·ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹ä¸Šè¿°`HOC`è¿›è¡Œæ”¹é€ å‡çº§ï¼Œæ˜¯ç»„ä»¶å¯ä»¥æ ¹æ®å®šåˆ¶åŒ–æ–¹å‘ï¼Œå»æ¸²æŸ“ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯`HOC`ç”Ÿæˆçš„æ—¶å€™ï¼Œå·²ç»æŒ‰ç…§æŸç§å¥‘çº¦å»æ‰§è¡Œæ¸²æŸ“ã€‚

```jsx
function HOC(rule) {
  return function (Component) {
    return function renderWrapComponent(props) {
      const dep = rule(props)
      const RenderElement = useMemo(() => <Component {...props} />, [dep])
      return RenderElement
    }
  }
}
/* åªæœ‰ props ä¸­ num å˜åŒ– ï¼Œæ¸²æŸ“ç»„ä»¶  */
@HOC((props) => props['num'])
class IndexHoc extends React.Component {
  render() {
    console.log(`ç»„ä»¶ä¸€æ¸²æŸ“`, this.props)
    return <div> ç»„ä»¶ä¸€ ï¼š hello,world </div>
  }
}

/* åªæœ‰ props ä¸­ num1 å˜åŒ– ï¼Œæ¸²æŸ“ç»„ä»¶  */
@HOC((props) => props['num1'])
class IndexHoc1 extends React.Component {
  render() {
    console.log(`ç»„ä»¶äºŒæ¸²æŸ“`, this.props)
    return <div> ç»„ä»¶äºŒ ï¼š my name is alien </div>
  }
}
export default () => {
  const [num, setNumber] = useState(0)
  const [num1, setNumber1] = useState(0)
  const [num2, setNumber2] = useState(0)
  return (
    <div>
      <IndexHoc num={num} num1={num1} num2={num2} />
      <IndexHoc1 num={num} num1={num1} num2={num2} />
      <button onClick={() => setNumber(num + 1)}>num++</button>
      <button onClick={() => setNumber1(num1 + 1)}>num1++</button>
      <button onClick={() => setNumber2(num2 + 1)}>num2++</button>
    </div>
  )
}
```

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/957c16b333b547e3bf99b5f635c055b3~tplv-k3u1fbpfcp-watermark.image)

å®Œç¾å®ç°äº†æ•ˆæœã€‚è¿™ç”¨é«˜é˜¶ç»„ä»¶æ¨¡å¼ï¼Œå¯ä»¥çµæ´»æ§åˆ¶`React`ç»„ä»¶å±‚é¢ä¸Šçš„ï¼Œ`props`æ•°æ®æµå’Œæ›´æ–°æµï¼Œä¼˜ç§€çš„é«˜é˜¶ç»„ä»¶æœ‰`mobx`ä¸­`observer`, `inject`, `react-redux`ä¸­çš„`connect`, æ„Ÿå…´è¶£çš„åŒå­¦ï¼Œå¯ä»¥æŠ½æ—¶é—´ç ”ç©¶ä¸€ä¸‹ã€‚

##### èµ‹èƒ½ç»„ä»¶

é«˜é˜¶ç»„ä»¶é™¤äº†ä¸Šè¿°ä¸¤ç§åŠŸèƒ½ä¹‹å¤–ï¼Œè¿˜å¯ä»¥èµ‹èƒ½ç»„ä»¶ï¼Œæ¯”å¦‚åŠ ä¸€äº›**é¢å¤–ç”Ÿå‘½å‘¨æœŸï¼ŒåŠ«æŒäº‹ä»¶ï¼Œç›‘æ§æ—¥å¿—**ç­‰ç­‰ã€‚

###### åŠ«æŒåŸå‹é“¾-åŠ«æŒç”Ÿå‘½å‘¨æœŸï¼Œäº‹ä»¶å‡½æ•°

1. å±æ€§ä»£ç†å®ç°

```jsx
function HOC(Component) {
  const proDidMount = Component.prototype.componentDidMount
  Component.prototype.componentDidMount = function () {
    console.log('åŠ«æŒç”Ÿå‘½å‘¨æœŸï¼šcomponentDidMount')
    proDidMount.call(this)
  }
  return class wrapComponent extends React.Component {
    render() {
      return <Component {...this.props} />
    }
  }
}
@HOC
class Index extends React.Component {
  componentDidMount() {
    console.log('â€”â€”â€”didMountedâ€”â€”â€”')
  }
  render() {
    return <div>hello,world</div>
  }
}
```

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abe21724cf8141a491cc3fab2dea7b46~tplv-k3u1fbpfcp-watermark.image) 2. åå‘ç»§æ‰¿å®ç°
åå‘ç»§æ‰¿ï¼Œå› ä¸ºåœ¨ç»§æ‰¿åŸæœ‰ç»„ä»¶çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å¯¹åŸæœ‰ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæˆ–äº‹ä»¶è¿›è¡ŒåŠ«æŒï¼Œç”šè‡³æ˜¯æ›¿æ¢ã€‚

```jsx
function HOC(Component) {
  const didMount = Component.prototype.componentDidMount
  return class wrapComponent extends Component {
    componentDidMount() {
      console.log('------åŠ«æŒç”Ÿå‘½å‘¨æœŸ------')
      if (didMount) {
        didMount.apply(this) /* æ³¨æ„ `this` æŒ‡å‘é—®é¢˜ã€‚ */
      }
    }
    render() {
      return super.render()
    }
  }
}

@HOC
class Index extends React.Component {
  componentDidMount() {
    console.log('â€”â€”â€”didMountedâ€”â€”â€”')
  }
  render() {
    return <div>hello,world</div>
  }
}
```

###### äº‹ä»¶ç›‘æ§

`HOC`è¿˜å¯ä»¥å¯¹åŸæœ‰ç»„ä»¶è¿›è¡Œç›‘æ§ã€‚æ¯”å¦‚å¯¹ä¸€äº›äº‹ä»¶ç›‘æ§ï¼Œé”™è¯¯ç›‘æ§ï¼Œäº‹ä»¶ç›‘å¬ç­‰ä¸€ç³»åˆ—æ“ä½œã€‚

1. ç»„ä»¶å†…çš„äº‹ä»¶ç›‘å¬
   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åšä¸€ä¸ª`HOC`, åªå¯¹ç»„ä»¶å†…çš„ç‚¹å‡»äº‹ä»¶åšä¸€ä¸ªç›‘å¬æ•ˆæœã€‚

```jsx
function ClickHoc(Component) {
  return function Wrap(props) {
    const dom = useRef(null)
    useEffect(() => {
      const handerClick = () => console.log('å‘ç”Ÿç‚¹å‡»äº‹ä»¶')
      dom.current.addEventListener('click', handerClick)
      return () => dom.current.removeEventListener('click', handerClick)
    }, [])
    return (
      <div ref={dom}>
        <Component {...props} />
      </div>
    )
  }
}

@ClickHoc
class Index extends React.Component {
  render() {
    return (
      <div className="index">
        <p>helloï¼Œworld</p>
        <button>ç»„ä»¶å†…éƒ¨ç‚¹å‡»</button>
      </div>
    )
  }
}
export default () => {
  return (
    <div className="box">
      <Index />
      <button>ç»„ä»¶å¤–éƒ¨ç‚¹å‡»</button>
    </div>
  )
}
```

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2e80fb646d654536af836b7d038fd62b~tplv-k3u1fbpfcp-watermark.image)

###### ref åŠ©åŠ›æ“æ§ç»„ä»¶å®ä¾‹

å¯¹äºå±æ€§ä»£ç†æˆ‘ä»¬è™½ç„¶ä¸èƒ½ç›´æ¥è·å–ç»„ä»¶å†…çš„çŠ¶æ€ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡`ref`è·å–ç»„ä»¶å®ä¾‹,è·å–åˆ°ç»„ä»¶å®ä¾‹ï¼Œå°±å¯ä»¥è·å–ç»„ä»¶çš„ä¸€äº›çŠ¶æ€ï¼Œæˆ–æ˜¯æ‰‹åŠ¨è§¦å‘ä¸€äº›äº‹ä»¶ï¼Œè¿›ä¸€æ­¥å¼ºåŒ–ç»„ä»¶ï¼Œä½†æ˜¯æ³¨æ„çš„æ˜¯ï¼š`class`å£°æ˜çš„æœ‰çŠ¶æ€ç»„ä»¶æ‰æœ‰å®ä¾‹ï¼Œ`function`å£°æ˜çš„æ— çŠ¶æ€ç»„ä»¶ä¸å­˜åœ¨å®ä¾‹ã€‚

1. å±æ€§ä»£ç†-æ·»åŠ é¢å¤–ç”Ÿå‘½å‘¨æœŸ
   æˆ‘ä»¬å¯ä»¥é’ˆå¯¹æŸä¸€ç§æƒ…å†µ, ç»™ç»„ä»¶å¢åŠ é¢å¤–çš„ç”Ÿå‘½å‘¨æœŸï¼Œç›‘å¬`number`æ”¹å˜ï¼Œå¦‚æœ`number`æ”¹å˜ï¼Œå°±è‡ªåŠ¨è§¦å‘ç»„ä»¶çš„ç›‘å¬å‡½æ•°`handerNumberChange`ã€‚å…·ä½“å†™æ³•å¦‚ä¸‹

```jsx
function Hoc(Component) {
  return class WrapComponent extends React.Component {
    constructor() {
      super()
      this.node = null
    }
    UNSAFE_componentWillReceiveProps(nextprops) {
      if (nextprops.number !== this.props.number) {
        this.node.handerNumberChange && this.node.handerNumberChange.call(this.node)
      }
    }
    render() {
      return <Component {...this.props} ref={(node) => (this.node = node)} />
    }
  }
}
@Hoc
class Index extends React.Component {
  handerNumberChange() {
    /* ç›‘å¬ number æ”¹å˜ */
  }
  render() {
    return <div>hello,world</div>
  }
}
```

è¿™ç§å†™æ³•æœ‰ç‚¹ä¸å°½äººæ„ï¼Œå¤§å®¶ä¸è¦ç€æ€¥ï¼Œåœ¨æºç å®æˆ˜éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä¼šä»‹ç»ä¸€ç§æ›´å¥½çš„åœºæ™¯ã€‚æ–¹ä¾¿å¤§å®¶ç†è§£`HOC`å¯¹åŸæœ‰ç»„ä»¶çš„èµ‹èƒ½ã€‚

##### æ€»ç»“

ä¸Šé¢æˆ‘åˆ†åˆ«æŒ‰ç…§`HOC`ä¸»è¦åŠŸèƒ½ï¼Œ**å¼ºåŒ–`props`ï¼Œ æ§åˆ¶æ¸²æŸ“ï¼Œèµ‹èƒ½ç»„ä»¶**ä¸‰ä¸ªæ–¹å‘å¯¹`HOC`ç¼–å†™åšäº†ä¸€ä¸ªè¯¦ç»†ä»‹ç»ï¼Œå’Œåº”ç”¨åœºæ™¯çš„ä»‹ç»ï¼Œç›®çš„è®©å¤§å®¶åœ¨ç†è§£é«˜é˜¶ç»„ä»¶çš„æ—¶å€™ï¼Œæ›´æ˜ç™½ä»€ä¹ˆæ—¶å€™ä¼šç”¨åˆ°ï¼Ÿæ€ä¹ˆæ ·å»å†™ï¼Ÿ é‡Œé¢æ¶µç›–çš„çŸ¥è¯†ç‚¹æˆ‘æ€»ä¸€ä¸ªæ€»ç»“ã€‚

- å¯¹äºå±æ€§ä»£ç†`HOC`ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
  - å¼ºåŒ– props & æŠ½ç¦» stateã€‚
  - æ¡ä»¶æ¸²æŸ“ï¼Œæ§åˆ¶æ¸²æŸ“ï¼Œåˆ†ç‰‡æ¸²æŸ“ï¼Œæ‡’åŠ è½½ã€‚
  - åŠ«æŒäº‹ä»¶å’Œç”Ÿå‘½å‘¨æœŸ
  - ref æ§åˆ¶ç»„ä»¶å®ä¾‹
  - æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼Œæ—¥å¿—
- å¯¹äºåå‘ä»£ç†çš„`HOC`,æˆ‘ä»¬å¯ä»¥ï¼š
  - åŠ«æŒæ¸²æŸ“ï¼Œæ“çºµæ¸²æŸ“æ ‘
  - æ§åˆ¶/æ›¿æ¢ç”Ÿå‘½å‘¨æœŸï¼Œç›´æ¥è·å–ç»„ä»¶çŠ¶æ€ï¼Œç»‘å®šäº‹ä»¶ã€‚

æ¯ä¸ªåº”ç”¨åœºæ™¯ï¼Œæˆ‘éƒ½ä¸¾äº†ä¾‹å­ ğŸŒ°ğŸŒ°ï¼Œå¤§å®¶å¯ä»¥ç»“åˆä¾‹å­æ·±å…¥äº†è§£ä¸€ä¸‹å…¶åŸç†å’Œç”¨é€”ã€‚

#### é«˜é˜¶ç»„ä»¶æºç çº§å®è·µ

`HOC`çš„åº”ç”¨åœºæ™¯æœ‰å¾ˆå¤šï¼Œä¹Ÿæœ‰å¾ˆå¤šå¥½çš„å¼€æºé¡¹ç›®ï¼Œä¾›æˆ‘ä»¬å­¦ä¹ å’Œå‚è€ƒï¼Œæ¥ä¸‹æ¥æˆ‘çœŸå¯¹ä¸‰ä¸ªæ–¹å‘ä¸Šçš„åŠŸèƒ½ç”¨é€”ï¼Œåˆ†åˆ«ä»æºç è§’åº¦è§£æ`HOC`çš„ç”¨é€”ã€‚

##### 1. å¼ºåŒ– prop- withRoute

ç”¨è¿‡`withRoute`çš„åŒå­¦ï¼Œéƒ½æ˜ç™½å…¶ç”¨é€”ï¼Œ`withRoute`ç”¨é€”å°±æ˜¯ï¼Œå¯¹äºæ²¡æœ‰è¢«`Route`åŒ…è£¹çš„ç»„ä»¶ï¼Œç»™æ·»åŠ `history`å¯¹è±¡ç­‰å’Œè·¯ç”±ç›¸å…³çš„çŠ¶æ€ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨ä»»æ„ç»„ä»¶ä¸­ï¼Œéƒ½èƒ½å¤Ÿè·å–è·¯ç”±çŠ¶æ€ï¼Œè¿›è¡Œè·¯ç”±è·³è½¬ï¼Œè¿™ä¸ª`HOC`ç›®çš„å¾ˆæ¸…æ¥šï¼Œå°±æ˜¯å¼ºåŒ–`props`,æŠŠ`Router`ç›¸å…³çš„çŠ¶æ€éƒ½æ··å…¥åˆ°`props`ä¸­ï¼Œæˆ‘ä»¬çœ‹çœ‹å…·ä½“æ€ä¹ˆå®ç°çš„ã€‚

```jsx
function withRouter(Component) {
  const displayName = `withRouter(${Component.displayName || Component.name})`
  const C = (props) => {
    /*  è·å– */
    const { wrappedComponentRef, ...remainingProps } = props
    return (
      <RouterContext.Consumer>
        {(context) => {
          return <Component {...remainingProps} {...context} ref={wrappedComponentRef} />
        }}
      </RouterContext.Consumer>
    )
  }

  C.displayName = displayName
  C.WrappedComponent = Component
  /* ç»§æ‰¿é™æ€å±æ€§ */
  return hoistStatics(C, Component)
}

export default withRouter
```

`withRoute`çš„æµç¨‹å®é™…å¾ˆç®€å•ï¼Œå°±æ˜¯å…ˆä»`props`åˆ†ç¦»å‡º`ref`å’Œ`props`,ç„¶åä»å­˜æ”¾æ•´ä¸ª`route`å¯¹è±¡ä¸Šä¸‹æ–‡`RouterContext`å–å‡º`route`å¯¹è±¡,ç„¶åæ··å…¥åˆ°åŸå§‹ç»„ä»¶çš„`props`ä¸­ï¼Œæœ€åç”¨`hoistStatics`ç»§æ‰¿é™æ€å±æ€§ã€‚è‡³äº`hoistStatics`æˆ‘ä»¬ç¨åä¼šè®²åˆ°ã€‚

##### 2. æ§åˆ¶æ¸²æŸ“æ¡ˆä¾‹ connect

ç”±äº`connect`æºç æ¯”è¾ƒé•¿å’Œéš¾ä»¥ç†è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬æå–ç²¾é«“ï¼Œç²¾ç®€ç²¾ç®€å†ç²¾ç®€, æ€»ç»“çš„æ ¸å¿ƒåŠŸèƒ½å¦‚ä¸‹,`connect`çš„ä½œç”¨ä¹Ÿæœ‰åˆå¹¶`props`ï¼Œä½†æ˜¯æ›´é‡è¦çš„æ˜¯æ¥å—`state`ï¼Œæ¥æ§åˆ¶æ›´æ–°ç»„ä»¶ã€‚ä¸‹é¢è¿™ä¸ªä»£ç ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿å¤§å®¶ç†è§£ï¼Œæˆ‘éƒ½ç»™ç®€åŒ–äº†ã€‚å¸Œæœ›å¤§å®¶èƒ½å¤Ÿç†è§£`hoc`å¦‚ä½•æ´¾å‘å’Œæ§åˆ¶æ›´æ–°æµçš„ã€‚

```jsx
import store from './redux/store'
import { ReactReduxContext } from './Context'
import { useContext } from 'react'
function connect(mapStateToProps) {
  /* ç¬¬ä¸€å±‚ï¼š æ¥æ”¶è®¢é˜…stateå‡½æ•° */
  return function wrapWithConnect(WrappedComponent) {
    /* ç¬¬äºŒå±‚ï¼šæ¥æ”¶åŸå§‹ç»„ä»¶ */
    function ConnectFunction(props) {
      const [, forceUpdate] = useState(0)
      const { reactReduxForwardedRef, ...wrapperProps } = props

      /* å–å‡ºContext */
      const { store } = useContext(ReactReduxContext)

      /* å¼ºåŒ–propsï¼šåˆå¹¶ store state å’Œ props  */
      const trueComponentProps = useMemo(() => {
        /* åªæœ‰propsæˆ–è€…è®¢é˜…çš„stateå˜åŒ–ï¼Œæ‰è¿”å›åˆå¹¶åçš„props */
        return selectorFactory(mapStateToProps(store.getState()), wrapperProps)
      }, [store, wrapperProps])

      /* åªæœ‰ trueComponentProps æ”¹å˜æ—¶å€™,æ›´æ–°ç»„ä»¶ã€‚  */
      const renderedWrappedComponent = useMemo(
        () => <WrappedComponent {...trueComponentProps} ref={reactReduxForwardedRef} />,
        [reactReduxForwardedRef, WrappedComponent, trueComponentProps]
      )
      useEffect(() => {
        /* è®¢é˜…æ›´æ–° */
        const checkUpdate = () => forceUpdate(new Date().getTime())
        store.subscribe(checkUpdate)
      }, [store])
      return renderedWrappedComponent
    }
    /* React.memo åŒ…è£¹  */
    const Connect = React.memo(ConnectFunction)

    /* å¤„ç†hoc,è·å–refé—®é¢˜ */
    if (forwardRef) {
      const forwarded = React.forwardRef(function forwardConnectRef(props, ref) {
        return <Connect {...props} reactReduxForwardedRef={ref} reactReduxForwardedRef={ref} />
      })
      return hoistStatics(forwarded, WrappedComponent)
    }
    /* ç»§æ‰¿é™æ€å±æ€§ */
    return hoistStatics(Connect, WrappedComponent)
  }
}
export default Index
```

`connect`æ¶‰åŠåˆ°çš„åŠŸèƒ½ç‚¹è¿˜çœŸä¸å°‘å‘¢ï¼Œé¦–å…ˆç¬¬ä¸€å±‚æ¥å—è®¢é˜…å‡½æ•°ï¼Œç¬¬äºŒå±‚æ¥æ”¶åŸå§‹ç»„ä»¶ï¼Œç„¶åç”¨`forwardRef`å¤„ç†`ref`,ç”¨`hoistStatics`å¤„ç†é™æ€å±æ€§çš„ç»§æ‰¿ï¼Œåœ¨åŒ…è£…ç»„ä»¶å†…éƒ¨ï¼Œåˆå¹¶`props`,`useMemo`ç¼“å­˜åŸå§‹ç»„ä»¶ï¼Œåªæœ‰åˆå¹¶åçš„`props`å‘ç”Ÿå˜åŒ–ï¼Œæ‰æ›´æ–°ç»„ä»¶ï¼Œç„¶ååœ¨`useEffect`å†…éƒ¨é€šè¿‡`store.subscribe()`è®¢é˜…æ›´æ–°ã€‚è¿™é‡Œçœç•¥äº†`Subscription`æ¦‚å¿µï¼ŒçœŸæ­£çš„`connect`ä¸­æœ‰ä¸€ä¸ª`Subscription`ä¸“é—¨è´Ÿè´£è®¢é˜…æ¶ˆæ¯ã€‚

#### é«˜é˜¶ç»„ä»¶çš„æ³¨æ„äº‹é¡¹

##### 1. è°¨æ…ä¿®æ”¹åŸå‹é“¾

```jsx
function HOC(Component) {
  const proDidMount = Component.prototype.componentDidMount
  Component.prototype.componentDidMount = function () {
    console.log('åŠ«æŒç”Ÿå‘½å‘¨æœŸï¼šcomponentDidMount')
    proDidMount.call(this)
  }
  return Component
}
```

è¿™æ ·åšä¼šäº§ç”Ÿä¸€äº›ä¸è‰¯åæœã€‚æ¯”å¦‚å¦‚æœä½ å†ç”¨å¦ä¸€ä¸ªåŒæ ·ä¼šä¿®æ”¹`componentDidMount` çš„`HOC`å¢å¼ºå®ƒï¼Œé‚£ä¹ˆå‰é¢çš„`HOC`å°±ä¼šå¤±æ•ˆï¼åŒæ—¶ï¼Œè¿™ä¸ª`HOC`ä¹Ÿæ— æ³•åº”ç”¨äºæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„å‡½æ•°ç»„ä»¶ã€‚

##### 2. ç»§æ‰¿é™æ€å±æ€§

åœ¨ç”¨å±æ€§ä»£ç†çš„æ–¹å¼ç¼–å†™`HOC`çš„æ—¶å€™ï¼Œè¦æ³¨æ„çš„æ˜¯å°±æ˜¯ï¼Œé™æ€å±æ€§ä¸¢å¤±çš„é—®é¢˜ï¼Œå‰é¢æåˆ°äº†ï¼Œå¦‚æœä¸åšå¤„ç†ï¼Œé™æ€æ–¹æ³•å°±ä¼šå…¨éƒ¨ä¸¢å¤±ã€‚

###### æ‰‹åŠ¨ç»§æ‰¿

æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å°†åŸå§‹ç»„ä»¶çš„é™æ€æ–¹æ³•`copy`åˆ°`hoc`ç»„ä»¶ä¸Šæ¥ï¼Œä½†å‰ææ˜¯å¿…é¡»å‡†ç¡®çŸ¥é“åº”è¯¥æ‹·è´å“ªäº›æ–¹æ³•ã€‚

```jsx
function HOC(Component) {
  class WrappedComponent extends React.Component {
    /*...*/
  }
  // å¿…é¡»å‡†ç¡®çŸ¥é“åº”è¯¥æ‹·è´å“ªäº›æ–¹æ³•
  WrappedComponent.staticMethod = Component.staticMethod
  return WrappedComponent
}
```

###### å¼•å…¥ç¬¬ä¸‰æ–¹åº“

è¿™æ ·æ¯ä¸ªé™æ€æ–¹æ³•éƒ½ç»‘å®šä¼šå¾ˆç´¯ï¼Œå°¤å…¶å¯¹äºå¼€æºçš„`HOC`ï¼Œå¯¹åŸç”Ÿç»„ä»¶çš„é™æ€æ–¹æ³•æ˜¯æœªçŸ¥çš„,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`hoist-non-react-statics`è‡ªåŠ¨æ‹·è´æ‰€æœ‰çš„é™æ€æ–¹æ³•:

```jsx
import hoistNonReactStatic from 'hoist-non-react-statics'
function HOC(Component) {
  class WrappedComponent extends React.Component {
    /*...*/
  }
  hoistNonReactStatic(WrappedComponent, Component)
  return WrappedComponent
}
```

##### 3. è·¨å±‚çº§æ•è· ref

é«˜é˜¶ç»„ä»¶çš„çº¦å®šæ˜¯å°†æ‰€æœ‰`props`ä¼ é€’ç»™è¢«åŒ…è£…ç»„ä»¶ï¼Œä½†è¿™å¯¹äº`refs`å¹¶ä¸é€‚ç”¨ã€‚é‚£æ˜¯å› ä¸º`ref`å®é™…ä¸Šå¹¶ä¸æ˜¯ä¸€ä¸ª`prop` - å°±åƒ`key`ä¸€æ ·ï¼Œå®ƒæ˜¯ç”±`React`ä¸“é—¨å¤„ç†çš„ã€‚å¦‚æœå°†`ref`æ·»åŠ åˆ° HOC çš„è¿”å›ç»„ä»¶ä¸­ï¼Œåˆ™`ref`å¼•ç”¨æŒ‡å‘å®¹å™¨ç»„ä»¶ï¼Œè€Œä¸æ˜¯è¢«åŒ…è£…ç»„ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡`forwardRef`æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

```jsx
function HOC(Component, isRef) {
  class Wrap extends React.Component {
    render() {
      const { forwardedRef, ...otherprops } = this.props
      return <Component ref={forwardedRef} {...otherprops} />
    }
  }
  if (isRef) {
    return React.forwardRef((props, ref) => <Wrap forwardedRef={ref} {...props} />)
  }
  return Wrap
}

class Index extends React.Component {
  componentDidMount() {
    console.log(666)
  }
  render() {
    return <div>hello,world</div>
  }
}

const HocIndex = HOC(Index, true)

export default () => {
  const node = useRef(null)
  useEffect(() => {
    /* å°±å¯ä»¥è·¨å±‚çº§ï¼Œæ•è·åˆ° Index ç»„ä»¶çš„å®ä¾‹äº† */
    console.log(node.current.componentDidMount)
  }, [])
  return (
    <div>
      <HocIndex ref={node} />
    </div>
  )
}
```

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7fb292247ca1470bb1cb6498616284c2~tplv-k3u1fbpfcp-watermark.image)
å¦‚ä¸Šå°±è§£å†³äº†,`HOC`è·¨å±‚çº§æ•è·`ref`çš„é—®é¢˜ã€‚

##### 4. render ä¸­ä¸è¦å£°æ˜ HOC

ğŸ™… é”™è¯¯å†™æ³•ï¼š

```jsx
class Index extends React.Component {
  render() {
    const WrapHome = HOC(Home)
    return <WrapHome />
  }
}
```

å¦‚æœè¿™ä¹ˆå†™ï¼Œä¼šé€ æˆä¸€ä¸ªæå¤§çš„é—®é¢˜ï¼Œå› ä¸ºæ¯ä¸€æ¬¡`HOC`éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„`WrapHome`,`react diff`ä¼šåˆ¤å®šä¸¤æ¬¡ä¸æ˜¯åŒä¸€ä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆæ¯æ¬¡`Index`ç»„ä»¶ `render`è§¦å‘ï¼Œ`WrapHome`ï¼Œä¼šé‡æ–°æŒ‚è½½ï¼ŒçŠ¶æ€ä¼šå…¨éƒ½ä¸¢å¤±ã€‚

#### ç›¸å…³æ–‡ç« 

- [å‰ç«¯ä¼˜ç§€å®è·µä¸å®Œå…¨æŒ‡å—](https://juejin.cn/post/6932647134944886797)

### 2. [é™†å¥‡æœ€æ–°æ¼”è®²ï¼š2021 å¹´ï¼Œç¨‹åºå‘˜ä»¬åº”è¯¥å¦‚ä½•æå‡è‡ªæˆ‘ï¼Ÿ](https://mp.weixin.qq.com/s/4EBPtzfDlX3u1BhtmxnACg)

æ„¿ 2021 å¹´çš„ç¨‹åºå‘˜ä»¬ï¼Œçœ¼ä¸­æ»¡æ˜¯å¸Œæœ›ï¼Œèº«åæ›´æœ‰é£å…‰ã€‚

#### ç›¸å…³æ–‡ç« 

- [é™†å¥‡æœ€æ–°æ¼”è®²ï¼š2021 å¹´ï¼Œç¨‹åºå‘˜ä»¬åº”è¯¥å¦‚ä½•æå‡è‡ªæˆ‘ï¼Ÿ](https://mp.weixin.qq.com/s/4EBPtzfDlX3u1BhtmxnACg)

## 30 seconds of code

### ç›®æ ‡

æŸ¥æ‰¾ç»™å®šå­—ç¬¦ä¸²ä¸­å­å­—ç¬¦ä¸²çš„æ‰€æœ‰ç´¢å¼•

### æ ·ä¾‹è¾“å‡º:

```js
;[...indexOfSubstrings('tiktok tok tok tik tok tik', 'tik')] // [0, 15, 23]
;[...indexOfSubstrings('tutut tut tut', 'tut')] // [0, 2, 6, 10]
;[...indexOfSubstrings('hello', 'hi')] // []
```

### å‚è€ƒå®ç°

```js
const indexOfSubstrings = function* (str, searchValue) {
  let i = 0
  while (true) {
    const r = str.indexOf(searchValue, i)
    if (r !== -1) {
      yield r
      i = r + 1
    } else return
  }
}
```

## æ¯æ—¥ä¸€é—®

> ä»¥ä¸‹ä»£ç çš„è¿è¡Œç»“æœä¸º

```js
3.toString()
3..toString()
3...toString()
```

## æ¯æ—¥äºŒé—®

> ä»¥ä¸‹ä»£ç çš„è¿è¡Œç»“æœä¸º

```js
var a = [1, 2, 3],
  b = [1, 2, 3],
  c = [1, 2, 4]
a == b
a === b
a > c
a < c
```

### ä¸ŠæœŸçš„ç­”æ¡ˆ

#### ç¬¬ä¸€é¢˜

> ä»¥ä¸‹ä»£ç çš„è¿è¡Œç»“æœä¸º

```js
if ('http://giftwrapped.com/picture.jpg'.match('.gif')) {
  ;('a gif file')
} else {
  ;('not a gif file')
}
```

- ç­”æ¡ˆï¼š'a gif file'
- è§£æï¼š String.prototype.match æ¥å—ä¸€ä¸ªæ­£åˆ™, å¦‚æœä¸æ˜¯, æŒ‰ç…§ new RegExp(obj) è½¬åŒ–. æ‰€ä»¥ . å¹¶ä¸ä¼šè½¬ä¹‰ ã€‚ é‚£ä¹ˆ /gif å°±åŒ¹é…äº† /.gif/
- å·©å›ºï¼š

```js
if ('http://giftwrapped.com/picture.jpg'.indexOf('.gif')) {
  ;('a gif file')
} else {
  ;('not a gif file')
}
//indexOfå¦‚æœåŒ¹é…ä¸åˆ°è¿”å›æ˜¯-1   æ‰€ä»¥æ˜¯ 'a gif file'
```

#### ç¬¬äºŒé¢˜

> ä»¥ä¸‹ä»£ç çš„è¿è¡Œç»“æœä¸º

```js
;[, , ,].join(',')
```

- ç­”æ¡ˆï¼š",,"
- è§£æï¼šå› ä¸º javascript åœ¨å®šä¹‰æ•°ç»„çš„æ—¶å€™å…è®¸æœ€åä¸€ä¸ªå…ƒç´ åè·Ÿä¸€ä¸ª,
  æ‰€ä»¥è¿™ä¸ªæ•°ç»„é•¿åº¦æ˜¯ 3ï¼Œ
- å·©å›ºï¼š [,,1,].join(".").length // 3
